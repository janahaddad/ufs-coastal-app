

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>2. Building and Running the UFS Coastal &mdash; UFS Coastal Application main documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="UFS Coastal Application main documentation" href="index.html"/>
        <link rel="next" title="3. Configurations" href="Configurations.html"/>
        <link rel="prev" title="1. Introduction" href="Introduction.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> UFS Coastal Application
          

          
          </a>

          
            
            
              <div class="version">
                
                  <div class="version-dropdown">
                    <select class="version-list" id="version-list">
                      <option value=''>main</option>
                      
                        
                      
                        
                          <option value="">[placeholder]</option>
                        
                      
                    </select>
                  </div>
                
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Introduction.html">1. Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">2. Building and Running the UFS Coastal</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#supported-platforms-and-compilers">2.1. Supported Platforms and Compilers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-data">2.2. Get Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#downloading-the-ufs-coastal-code">2.3. Downloading the UFS Coastal Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-the-ufs-coastal">2.4. Building the UFS Coastal</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-required-modules">2.4.1. Loading the Required Modules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#on-noaa-level-1-2-systems">2.4.1.1. On NOAA Level 1 &amp; 2 Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="#on-other-systems">2.4.1.2. On Other Systems</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#setting-the-cmake-flags-environment-variable">2.4.2. Setting the <code class="docutils literal notranslate"><span class="pre">CMAKE_FLAGS</span></code> Environment Variable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#datm-ocn-configurations">2.4.2.1. DATM+OCN Configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#datm-ocn-wav-configurations">2.4.2.2. DATM+OCN+WAV Configurations</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#building-the-model">2.4.3. Building the Model</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#running-the-model">2.5. Running the Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#user-provided-configurations">2.5.1. User Provided Configurations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pre-configured-configurations-using-the-regression-test-script">2.5.2. Pre-configured Configurations Using the Regression Test Script</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#the-rt-coastal-conf-file">2.5.2.1. The <code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code> File</a></li>
<li class="toctree-l4"><a class="reference internal" href="#the-rt-sh-file">2.5.2.2. The <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> File</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Configurations.html">3. Configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="PortingModel.html">4. Porting UFS Coastal Model</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">UFS Coastal Application</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li><span class="section-number">2. </span>Building and Running the UFS Coastal</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/BuildingAndRunning.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <section id="building-and-running-the-ufs-coastal">
<span id="buildingandrunning"></span><h1><span class="section-number">2. </span>Building and Running the UFS Coastal<a class="headerlink" href="#building-and-running-the-ufs-coastal" title="Permalink to this heading">¶</a></h1>
<section id="supported-platforms-and-compilers">
<h2><span class="section-number">2.1. </span>Supported Platforms and Compilers<a class="headerlink" href="#supported-platforms-and-compilers" title="Permalink to this heading">¶</a></h2>
<p>Since the UFS Coastal is developed as a fork of the UFS Weather Model, the same platforms supported by the UFS Weather Model (<a class="reference external" href="https://ufs-weather-model.readthedocs.io/en/latest/CodeOverview.html#supported-platforms-and-compilers-for-running-the-ufs-weather-model">see list of suported platforms</a>) is also used by the UFS Coastal.</p>
<p>The prerequisite software libraries for building the UFS Coastal already exist in a centralized location on Level 1/pre configured systems, so users may skip dependency installation steps. On other systems, users will need to build the prerequisite libraries using <a class="reference external" href="https://github.com/JCSDA/spack-stack">spack-stack</a>. The extensive documentation about installing dependencies through the spack-stack can be found in <a class="reference external" href="https://spack-stack.readthedocs.io/en/latest/">here</a>.</p>
</section>
<section id="get-data">
<h2><span class="section-number">2.2. </span>Get Data<a class="headerlink" href="#get-data" title="Permalink to this heading">¶</a></h2>
<p>The ROMS input files for pre-configured cases can be downloaded from the <a class="reference external" href="https://github.com/myroms/roms_test/tree/main/IRENE">ROMS Test</a> GitHub repository.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>Need to place UFS Coastal specific data to cloud or common place along with some level of versioning.</p>
</div>
</section>
<section id="downloading-the-ufs-coastal-code">
<h2><span class="section-number">2.3. </span>Downloading the UFS Coastal Code<a class="headerlink" href="#downloading-the-ufs-coastal-code" title="Permalink to this heading">¶</a></h2>
<p>To clone the main branch of the <code class="docutils literal notranslate"><span class="pre">ufs-coastal</span></code> repository and update its submodules, execute the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">git clone --recursive https://github.com/oceanmodeling/ufs-coastal ufs-coastal</span>
<span class="go">cd ufs-coastal</span>
</pre></div>
</div>
<p>Compiling the model will take place within the <code class="docutils literal notranslate"><span class="pre">ufs-coastal</span></code> directory created by this command.</p>
</section>
<section id="building-the-ufs-coastal">
<h2><span class="section-number">2.4. </span>Building the UFS Coastal<a class="headerlink" href="#building-the-ufs-coastal" title="Permalink to this heading">¶</a></h2>
<section id="loading-the-required-modules">
<h3><span class="section-number">2.4.1. </span>Loading the Required Modules<a class="headerlink" href="#loading-the-required-modules" title="Permalink to this heading">¶</a></h3>
<p>The process for loading modules is fairly straightforward on Level 1 <a class="reference external" href="https://ufs-weather-model.readthedocs.io/en/latest/BuildingAndRunning.html#supported-platforms-compilers">supported platforms</a>. Users may need to make adjustments when running on other systems.</p>
<section id="on-noaa-level-1-2-systems">
<h4><span class="section-number">2.4.1.1. </span>On NOAA Level 1 &amp; 2 Systems<a class="headerlink" href="#on-noaa-level-1-2-systems" title="Permalink to this heading">¶</a></h4>
<p>Modulefiles for preconfigured platforms are located in <code class="docutils literal notranslate"><span class="pre">modulefiles/ufs_&lt;platform&gt;.&lt;compiler&gt;</span></code>. For example, to load the modules from the <code class="docutils literal notranslate"><span class="pre">ufs-coastal</span></code> directory on MSU’s Hercules:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">cd ufs-coastal</span>
<span class="go">module use modulefiles</span>
<span class="go">module load ufs_hercules.intel</span>
</pre></div>
</div>
</section>
<section id="on-other-systems">
<h4><span class="section-number">2.4.1.2. </span>On Other Systems<a class="headerlink" href="#on-other-systems" title="Permalink to this heading">¶</a></h4>
<p>If you are not running on one of the pre-configured platforms, you will need to install dependencies using spack-stack. The more detailed information about usage of spack-stack and dependency installation can be found in <a class="reference internal" href="PortingModel.html#portingmodel"><span class="std std-ref">porting section</span></a>.</p>
</section>
</section>
<section id="setting-the-cmake-flags-environment-variable">
<h3><span class="section-number">2.4.2. </span>Setting the <code class="docutils literal notranslate"><span class="pre">CMAKE_FLAGS</span></code> Environment Variable<a class="headerlink" href="#setting-the-cmake-flags-environment-variable" title="Permalink to this heading">¶</a></h3>
<p>The UFS Coastal can be built in one of several configurations (see <a class="reference internal" href="Configurations.html#ufs-coastal-configurations"><span class="std std-numref">Table 3.1</span></a> for common options). Also note that these configurations are specific to UFS Coastal and the wide range of supported configurations through the UFS Weather Model can be found in UFS Weather Model documentation <a class="reference external" href="https://ufs-weather-model.readthedocs.io/en/latest/Configurations.html">Configurations section</a>.</p>
<section id="datm-ocn-configurations">
<h4><span class="section-number">2.4.2.1. </span>DATM+OCN Configurations<a class="headerlink" href="#datm-ocn-configurations" title="Permalink to this heading">¶</a></h4>
<p><strong>ADCIRC</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export CMAKE_FLAGS=&quot;-DAPP=CSTLA -DADCIRC_CONFIG=PADCIRC -DCOUPLED=ON&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-DBUILD_ADCPREP</span></code> option can be also provided to build ADCIRC pre-processing tools like <code class="docutils literal notranslate"><span class="pre">adcprep</span></code> command that allows the creation of input files.
The <code class="docutils literal notranslate"><span class="pre">-DBUILD_UTILITIES</span></code> option can be also provided to build ADCIRC specific utility tools.</p>
</div>
<p><strong>FVCOM</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export CMAKE_FLAGS=&quot;-DAPP=CSTLF -DCOORDINATE_TYPE=SPHERICAL -DWET_DRY=ON&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-DAIR_PRESSURE</span></code> option can also be provided to use surface air pressure as addtional forcing.</p>
</div>
<p><strong>ROMS</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export CMAKE_FLAGS=&quot;-DAPP=CSTLR -DMY_CPP_FLAGS=BULK_FLUXES&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ROMS ocean model builds the <code class="docutils literal notranslate"><span class="pre">IRANE</span></code> application by default. <code class="docutils literal notranslate"><span class="pre">-DROMS_APP</span></code> and <code class="docutils literal notranslate"><span class="pre">ROMS_APP_DIR</span></code> can be provided to build custom configurations. Mode information about the <code class="docutils literal notranslate"><span class="pre">IRANE</span></code> configuration (CDEPS data atmosphere coupled with ROMS) can be found in <a class="reference external" href="https://github.com/myroms/roms_test/tree/main/IRENE/Coupling/roms_data_cmeps">ROMS Test repository</a>.</p>
</div>
<p><strong>SCHISM</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export CMAKE_FLAGS=&quot;-DAPP=CSTLS -DUSE_ATMOS=ON -DNO_PARMETIS=OFF -DOLDIO=ON&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">-DBUILD_TOOLS</span></code> option can be also provided to build SCHISM specific pre- and post-processing tools.</p>
</div>
<p><strong>WW3</strong></p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">export CMAKE_FLAGS=&quot;-DAPP=CSTLW -DPDLIB=ON&quot;</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The same options can be used both for standalone WW3 configuration (<code class="docutils literal notranslate"><span class="pre">standalone</span> <span class="pre">=</span> <span class="pre">true</span></code> option needs to be provided in <code class="docutils literal notranslate"><span class="pre">WAV_attributes</span></code> section of <code class="docutils literal notranslate"><span class="pre">ufs.configuration</span></code> namelist file) and also the one coupled with CDEPS data atmosphere.</p>
</div>
</section>
<section id="datm-ocn-wav-configurations">
<h4><span class="section-number">2.4.2.2. </span>DATM+OCN+WAV Configurations<a class="headerlink" href="#datm-ocn-wav-configurations" title="Permalink to this heading">¶</a></h4>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Add other configurations.</p>
</div>
</section>
</section>
<section id="building-the-model">
<h3><span class="section-number">2.4.3. </span>Building the Model<a class="headerlink" href="#building-the-model" title="Permalink to this heading">¶</a></h3>
<p>The UFS Weather Model uses the CMake build system. There is a build script called <code class="docutils literal notranslate"><span class="pre">build.sh</span></code> in the top-level directory of the UFS Coastal repository that configures the build environment and runs the <code class="docutils literal notranslate"><span class="pre">make</span></code> command. This script also checks that all necessary environment variables have been set.</p>
<p>The UFS Coastal can be built by running the following command from the <code class="docutils literal notranslate"><span class="pre">ufs-coastal</span></code> directory once <code class="docutils literal notranslate"><span class="pre">CMAKE_FLAGS</span></code> is set:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">./build.sh</span>
</pre></div>
</div>
<p>Once <code class="docutils literal notranslate"><span class="pre">build.sh</span></code> is finished, users should see the executable, named <code class="docutils literal notranslate"><span class="pre">ufs_model</span></code>, in the <code class="docutils literal notranslate"><span class="pre">ufs-coastal/build/</span></code> directory. If users prefer to build in a different directory, specify the <code class="docutils literal notranslate"><span class="pre">BUILD_DIR</span></code> environment variable. For example: <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">BUILD_DIR=test_cpld</span></code> will build in the <code class="docutils literal notranslate"><span class="pre">ufs-coastal/test_cpld</span></code> directory instead.</p>
<p>Expert help is available through <a class="reference external" href="https://github.com/oceanmodeling/ufs-coastal/discussions/categories/q-a">GitHub Discussions</a>. Users may post questions there for help with difficulties related to the UFS Coastal.</p>
</section>
</section>
<section id="running-the-model">
<h2><span class="section-number">2.5. </span>Running the Model<a class="headerlink" href="#running-the-model" title="Permalink to this heading">¶</a></h2>
<section id="user-provided-configurations">
<h3><span class="section-number">2.5.1. </span>User Provided Configurations<a class="headerlink" href="#user-provided-configurations" title="Permalink to this heading">¶</a></h3>
<p>Since the UFS Coastal does not have workflow capability in the application layer (<a class="reference external" href="https://github.com/oceanmodeling/ufs-coastal-app">UFS Coastal Application</a>) yet, users need to populate namelist and input files manually. At this point, the best practice is to run UFS Coastal with a custom configuration/application is to run the similar configuration using UFS Coastal Regression Testing (RT) framework  and populate the run directory. Then, the run directory can be used as a base to build custom configuration by replacing model and component specific configuration and input files. The more information about running UFS Coastal specific RTs can be found in the following section.</p>
</section>
<section id="pre-configured-configurations-using-the-regression-test-script">
<h3><span class="section-number">2.5.2. </span>Pre-configured Configurations Using the Regression Test Script<a class="headerlink" href="#pre-configured-configurations-using-the-regression-test-script" title="Permalink to this heading">¶</a></h3>
<p>Users can run a number of preconfigured UFS Coastal specific regression test cases from the <code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code> file (<code class="docutils literal notranslate"><span class="pre">rt.conf</span></code> includes RTs supported by UFS Weather Model) using the regression test script <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> in the <code class="docutils literal notranslate"><span class="pre">tests</span></code> directory. <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> is the top-level script that calls lower-level scripts to build specified UFS Coastal and UFS Weather Model configurations, set up environments, and run tests. This section aims to give brief information about running specific model configurations under UFS Coastal through the use of Regression Testing (RT) framework.</p>
<section id="the-rt-coastal-conf-file">
<span id="rt-coastal-conf"></span><h4><span class="section-number">2.5.2.1. </span>The <code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code> File<a class="headerlink" href="#the-rt-coastal-conf-file" title="Permalink to this heading">¶</a></h4>
<p>Each line in the PSV (Pipe-separated values) file, <code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code>, contains information to build and run the specific model configuration. The file includes two lines for each model configuration starting as <code class="docutils literal notranslate"><span class="pre">COMPILE</span></code> and <code class="docutils literal notranslate"><span class="pre">RUN</span></code>. The similar configurations could have a single <code class="docutils literal notranslate"><span class="pre">COMPILE</span></code> line but multiple <code class="docutils literal notranslate"><span class="pre">RUN</span></code> lines. In this case, a single compile step can be used to run multiple similar configurations.</p>
<p><strong>COMPILE</strong></p>
<table class="colwidths-given docutils align-default" id="id3">
<caption><span class="caption-number">Table 2.1 </span><span class="caption-text">Description of Compile Section of <code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code></span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">COMPILE</span></code>, It specifies the following information is to be used in setting up a compile job</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>It specifies the compile number. This is used as a reference for compile failures</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Relates to the compiler to use in build (intel or gnu)</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>It specifies <code class="docutils literal notranslate"><span class="pre">CMAKE</span></code> options for the build. This is very similar to setting <code class="docutils literal notranslate"><span class="pre">CMAKE_FLAGS</span></code> to build model executable outside of the RT framework</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Machines to run on (<code class="docutils literal notranslate"><span class="pre">-</span></code> is used to ignore specified machines, <code class="docutils literal notranslate"><span class="pre">+</span></code> is used to only run on specified machines)</p></td>
</tr>
<tr class="row-odd"><td><p>6</p></td>
<td><p>Relates to the control of the compile job only if FV3 was present, previously used to run a test w/o compiling code. It can be set to <code class="docutils literal notranslate"><span class="pre">fv3</span></code> in all the cases.</p></td>
</tr>
</tbody>
</table>
<p><strong>RUN</strong></p>
<table class="colwidths-given docutils align-default" id="id4">
<caption><span class="caption-number">Table 2.2 </span><span class="caption-text">Description of Run Section of <code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code></span><a class="headerlink" href="#id4" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 13%" />
<col style="width: 88%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">RUN</span></code>, It specifies following information is to be used in setting up a model run</p></td>
</tr>
<tr class="row-odd"><td><p>2</p></td>
<td><p>Test name. The test in the tests/tests directory should be sourced</p></td>
</tr>
<tr class="row-even"><td><p>3</p></td>
<td><p>Machines to run on (- is used to ignore specified machines, + is used to only run on specified machines)</p></td>
</tr>
<tr class="row-odd"><td><p>4</p></td>
<td><p>Controls whether the run creates its own baseline or it uses the baseline from a different (control) test</p></td>
</tr>
<tr class="row-even"><td><p>5</p></td>
<td><p>Test name to compare baselines with if not itself</p></td>
</tr>
</tbody>
</table>
<p>The order of lines in <code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code> matters since <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> processes them sequentially; a <code class="docutils literal notranslate"><span class="pre">RUN</span></code> line should be preceded by a <code class="docutils literal notranslate"><span class="pre">COMPILE</span></code> line that builds the model used in the test. The following
<code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code> file builds the ROMS ocean model coupled with CDEPS data atmosphere:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">COMPILE | 16 | intel | -DAPP=CSTLR -DMY_CPP_FLAGS=BULK_FLUXES | | fv3 |</span>
<span class="go">RUN | coastal_irene_atm2roms | | baseline |</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">rt_coastal.conf</span></code> file includes a large number of tests. If the user wants to run only specific tests, <code class="docutils literal notranslate"><span class="pre">-n</span></code> argument can be used. The <code class="docutils literal notranslate"><span class="pre">-l</span> <span class="pre">rt_coastal.conf</span></code> option can be used to run only UFS Coastal specific RTs. The <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> uses the <code class="docutils literal notranslate"><span class="pre">rt.conf</span></code> file by default.</p>
</section>
<section id="the-rt-sh-file">
<span id="rt-sh"></span><h4><span class="section-number">2.5.2.2. </span>The <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> File<a class="headerlink" href="#the-rt-sh-file" title="Permalink to this heading">¶</a></h4>
<p>This section contains additional information on command line options and troubleshooting for the <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> file.</p>
<p>To display detailed information on how to use <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code>, users can simply run <code class="docutils literal notranslate"><span class="pre">./rt.sh</span></code>, which will output the following options:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Usage: ./rt.sh -a &lt;account&gt; | -b &lt;file&gt; | -c | -d | -e | -h | -k | -l &lt;file&gt; | -m | -n &lt;name&gt; | -r | -w</span>

<span class="go">  -a  &lt;account&gt; to use on for HPC queue</span>
<span class="go">  -b  create new baselines only for tests listed in &lt;file&gt;</span>
<span class="go">  -c  create new baseline results</span>
<span class="go">  -d  delete run directories that are not used by other tests</span>
<span class="go">  -e  use ecFlow workflow manager</span>
<span class="go">  -h  display this help</span>
<span class="go">  -k  keep run directory after rt.sh is completed</span>
<span class="go">  -l  runs test specified in &lt;file&gt;</span>
<span class="go">  -m  compare against new baseline results</span>
<span class="go">  -n  run single test &lt;name&gt;</span>
<span class="go">  -r  use Rocoto workflow manager</span>
<span class="go">  -w  for weekly_test, skip comparing baseline results</span>
</pre></div>
</div>
<p>When running a large number (10’s or 100’s) of tests, the <code class="docutils literal notranslate"><span class="pre">-e</span></code> or <code class="docutils literal notranslate"><span class="pre">-r</span></code> options can significantly decrease testing time by using a workflow manager (ecFlow or Rocoto, respectively) to queue the jobs
according to dependencies and run them concurrently.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Workflow Engine <a class="reference external" href="https://confluence.ecmwf.int/display/ECFLOW">ecFlow</a> is used with <code class="docutils literal notranslate"><span class="pre">-e</span></code> argument and <a class="reference external" href="https://github.com/christopherwharrop/rocoto">Rocoto</a> is used with <code class="docutils literal notranslate"><span class="pre">-r</span></code> argument. The Workflow Engine needs to be installed to the system to use these options. The Tier-1 platforms might have those workflow engines but Tear-2 level supported systems and custom installations might not have them.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the UFS Coastal specific input files are not part of the UFS Weather Model input files, the location of the RT directory (defined by <code class="docutils literal notranslate"><span class="pre">DISKNM</span></code> variable) in <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> needs to be modified to run UFS Coastal specific RTs. To do that user needs to edit platform (i.e. Orion, Hercules) specific section of <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> and set <code class="docutils literal notranslate"><span class="pre">DISKNM</span></code> variable. For both <code class="docutils literal notranslate"><span class="pre">Orion</span></code> and <code class="docutils literal notranslate"><span class="pre">Hercules</span></code> platforms, <code class="docutils literal notranslate"><span class="pre">/work2/noaa/nems/tufuk/RT</span></code> directory is used to set <code class="docutils literal notranslate"><span class="pre">DISKNM</span></code> variable.</p>
</div>
<p>To run <code class="docutils literal notranslate"><span class="pre">rt.sh</span></code> using a custom configuration file and the Rocoto workflow manager:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">./rt.sh -r -l rt_coastal.conf</span>
</pre></div>
</div>
<p>To run a single test from custom configuration file:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">./rt.sh -l rt_coastal.conf -k -n coastal_irene_atm2roms</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">-k</span></code> argument is used to keep the run directory for further reference.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">-a</span></code> argument can be used to specify account to job scheduler</p>
</div>
<p>The up-to-date list of supported and tested (the RTs that is indicated as bold) RTs can be seen in <a class="reference external" href="https://github.com/oceanmodeling/ufs-coastal/wiki/Current-Status-of-UFS%E2%80%90Coastal-Implementation">UFS Coastal repository Wiki page</a>.</p>
</section>
</section>
</section>
</section>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="Configurations.html" class="btn btn-neutral float-right" title="3. Configurations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Introduction.html" class="btn btn-neutral" title="1. Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2023, NOS Storm Surge Modeling Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
     
<script>var version_json_loc = "../../versions.json";</script>


</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/pop_ver.js"></script>
    

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>